<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>홀짝 도박 시뮬레이션</title>
<style>
  body {
    font-family: "Arial", sans-serif;
    background: linear-gradient(135deg, #2b5876, #4e4376);
    color: white;
    text-align: center;
    padding-top: 50px;
    overflow: hidden;
    transition: background 0.6s ease;
  }
  h1 { font-size: 28px; margin-bottom: 10px; }
  #balance, #goal { font-size: 22px; margin: 8px; }
  #result { font-size: 20px; margin: 25px; transition: all 0.5s ease; }
  input[type="number"] {
    padding: 10px; border-radius: 5px; border: none; font-size: 16px; width: 150px; text-align: center;
  }
  button {
    padding: 12px 20px;
    margin: 10px;
    font-size: 18px;
    border: none;
    border-radius: 10px;
    background-color: #6a11cb;
    color: white;
    cursor: pointer;
    transition: all 0.3s;
  }
  button:hover { transform: scale(1.1); background-color: #2575fc; }

  /* 시각 효과 */
  .flash {
    animation: flash 0.3s;
  }
  @keyframes flash {
    0% { background-color: #00ff88; }
    100% { background: linear-gradient(135deg, #2b5876, #4e4376); }
  }

  /* 돈 증감 표시 */
  .floating-text {
    position: absolute;
    font-size: 24px;
    font-weight: bold;
    pointer-events: none;
    animation: floatUp 1s ease-out forwards;
  }
  @keyframes floatUp {
    0% { opacity: 1; transform: translateY(0); }
    100% { opacity: 0; transform: translateY(-80px); }
  }
</style>
</head>
<body>
  <h1>🎲 홀짝 도박 시뮬레이션 🎲</h1>
  <div id="balance">💰 보유 금액: 500,000원</div>
  <div id="goal">🎯 목표 금액: 5,000,000원</div>
  <div>
    <input type="number" id="bet" placeholder="배팅 금액 입력" min="1">
  </div>
  <div>
    <button onclick="playGame('홀')">홀</button>
    <button onclick="playGame('짝')">짝</button>
  </div>
  <div id="result"></div>

  <!-- 효과음 -->
  <audio id="betSound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>
  <audio id="winSound" src="https://actions.google.com/sounds/v1/cartoon/concussive_hit_guitar_boing.ogg" preload="auto"></audio>
  <audio id="loseSound" src="https://actions.google.com/sounds/v1/cartoon/slap.ogg" preload="auto"></audio>

  <script>
    let balance = 500000;
    let failCount = 0;
    let winRate = 0.35; // 초기 성공 확률 35%

    const balanceDisplay = document.getElementById("balance");
    const resultDisplay = document.getElementById("result");
    const betSound = document.getElementById("betSound");
    const winSound = document.getElementById("winSound");
    const loseSound = document.getElementById("loseSound");

    function playGame(choice) {
      const bet = Number(document.getElementById("bet").value);

      if (bet <= 0 || isNaN(bet)) {
        alert("배팅 금액을 입력하세요!");
        return;
      }

      if (balance <= bet * 0.5) {
        alert("⚠️ 보유금이 너무 적습니다!");
        return;
      }

      // 배팅 시작 시 효과음 & 시각 효과
      document.body.classList.add("flash");
      setTimeout(() => document.body.classList.remove("flash"), 300);
      betSound.currentTime = 0;
      betSound.play();

      // 게임 결과 계산
      const random = Math.random();
      const outcome = random < winRate ? choice : (choice === '홀' ? '짝' : '홀');
      const isWin = choice === outcome;

      if (isWin) {
        const gain = bet * 2;
        balance += gain;
        resultDisplay.innerHTML = `✅ 승리! ${gain.toLocaleString()}원 획득!`;
        winSound.currentTime = 0;
        winSound.play();
        failCount = 0;
        winRate = Math.max(0.25, winRate - 0.02);
        showFloatingText(`+${gain.toLocaleString()}`, "lime");
      } else {
        const loss = bet * 2.5;
        balance -= loss;
        resultDisplay.innerHTML = `❌ 패배... ${loss.toLocaleString()}원 손실`;
        loseSound.currentTime = 0;
        loseSound.play();
        failCount++;
        if (failCount >= 5) {
          winRate = Math.min(0.5, winRate + 0.1);
          failCount = 0;
        }
        showFloatingText(`-${loss.toLocaleString()}`, "red");
      }

      balanceDisplay.innerHTML = `💰 보유 금액: ${balance.toLocaleString()}원`;

      // 파산 or 목표 달성 시 초기화
      if (balance <= 0) {
        alert("💀 파산하셨습니다! 다시 시작합니다.");
        resetGame();
      } else if (balance >= 5000000) {
        alert("🎉 축하합니다! 5,000,000원 달성! 게임이 초기화됩니다.");
        resetGame();
      }
    }

    function resetGame() {
      balance = 500000;
      failCount = 0;
      winRate = 0.35;
      balanceDisplay.innerHTML = `💰 보유 금액: ${balance.toLocaleString()}원`;
      resultDisplay.innerHTML = "";
    }

    // 화면 아무 곳에 +금액 / -금액 표시
    function showFloatingText(text, color) {
      const span = document.createElement("span");
      span.classList.add("floating-text");
      span.style.color = color;
      span.innerText = text;

      // 화면 랜덤 위치
      span.style.left = Math.random() * (window.innerWidth - 100) + "px";
      span.style.top = Math.random() * (window.innerHeight - 100) + "px";

      document.body.appendChild(span);
      setTimeout(() => span.remove(), 1000);
    }
  </script>
</body>
</html>
